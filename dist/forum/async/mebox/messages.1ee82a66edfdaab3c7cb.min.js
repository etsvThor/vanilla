(self.webpackChunkvanillaforum=self.webpackChunkvanillaforum||[]).push([[3498],{83673:function(e,t,n){"use strict";n.d(t,{T:function(){return x},Z:function(){return I}});var r=n(6610),a=n(5991),o=n(10379),s=n(46070),i=n(77608),c=n(67294),u=n(64833),l=n(67036),f=n(93266),m=n(96156),p=n(92366),d=n(71055),h=n(10389),g=n(41033),y=n(13901),v=n(35138),E=n(85819),b=n(67920);function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach((function(t){(0,m.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var x,M=(0,v.yI)((function(){var e=(0,y.Cg)("meBoxMessage");return{spacing:e("spacing",{padding:{top:8,right:12,bottom:8,left:12}}),imageContainer:e("imageContainer",{width:40}),unreadDot:e("unreadDot",{width:8})}})),C=(0,v.yI)((function(){var e=(0,g.OF)(),t=M(),n=(0,y.Y7)("meBoxMessage");return{root:n(Z({display:"block"},{"& + &":{borderTop:"solid 1px ".concat(d.w.colorOut(e.border.color))}})),link:n("link",Z(Z(Z({},(0,p.userSelect)()),{},{display:"flex",flexWrap:"nowrap",color:"inherit"},b.W.padding(t.spacing.padding)),(0,p.buttonStates)({allStates:{textShadow:"none"},hover:{backgroundColor:d.w.colorOut(e.states.hover.highlight)},focus:{backgroundColor:d.w.colorOut(e.states.hover.highlight)},active:{backgroundColor:d.w.colorOut(e.states.active.highlight)}}))),imageContainer:n("imageContainer",{position:"relative",width:(0,h.dd)(t.imageContainer.width),height:(0,h.dd)(t.imageContainer.width),flexBasis:(0,h.dd)(t.imageContainer.width),borderRadius:(0,E.aQ)(50),overflow:"hidden",border:"solid 1px ".concat(e.border.color.toString())}),image:n("image",Z({width:(0,h.dd)(t.imageContainer.width),height:(0,h.dd)(t.imageContainer.width)},(0,p.objectFitWithFallback)())),status:n("status",Z({position:"relative",width:(0,h.dd)(t.unreadDot.width),flexBasis:(0,h.dd)(t.unreadDot.width)},{"&.isUnread":Z({},{"&:after":Z(Z({},b.W.absolute.middleRightOfParent()),{},{content:(0,E.mW)(""),height:(0,h.dd)(t.unreadDot.width),width:(0,h.dd)(t.unreadDot.width),backgroundColor:e.mainColors.primary.toString(),borderRadius:(0,E.aQ)(50)})})})),contents:n("contents",Z(Z({flexGrow:1},b.W.padding({left:t.spacing.padding.left,right:t.spacing.padding.right})),{},{maxWidth:(0,E.yx)("100% - ".concat((0,h.dd)(t.unreadDot.width+t.imageContainer.width)))})),message:n("message",{lineHeight:e.lineHeights.excerpt,color:d.w.colorOut(e.mainColors.fg)})}})),N=n(10965),O=n(63754),S=n(94184),R=n.n(S),B=n(74138),D=n(95762),A=n(17225);function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,i.Z)(e);if(t){var a=(0,i.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,s.Z)(this,n)}}!function(e){e.NOTIFICATION="notification",e.MESSAGE="message"}(x||(x={}));var I=function(e){(0,o.Z)(n,e);var t=k(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,a.Z)(n,[{key:"render",value:function(){var e,t=this.props,n=t.unread,r=t.message,a=t.timestamp,o=t.to,s=t.photoAlt,i=t.photo,m=C(),p=(0,N.Kw)();if(this.props.type===x.MESSAGE){var d=this.props.authors,h=this.props.authors.length;d&&h>0&&(e=d.map((function(e,t){return e?c.createElement(c.Fragment,{key:"meBoxAuthor-".concat(t)},c.createElement("strong",null,e.name),"".concat(t<h-1?", ":"")):c.createElement(c.Fragment,{key:"meBoxAuthor-".concat(t)})})))}return c.createElement("li",{className:R()("meBoxMessage",this.props.className,m.root)},c.createElement(f.Z,{to:o,className:R()("meBoxMessage-link",m.link),tabIndex:0},c.createElement("div",{className:R()(m.imageContainer,(0,D.re)().root)},i?c.createElement("img",{className:m.image,src:i,alt:s,loading:"lazy"}):c.createElement(B.Gx,{className:m.image,photoAlt:s})),c.createElement("div",{className:R()("meBoxMessage-contents",m.contents)},!!e&&c.createElement("div",{className:R()("meBoxMessage-message",m.message)},e),c.createElement("div",{className:R()("meBoxMessage-message",m.message),dangerouslySetInnerHTML:{__html:r}}),c.createElement("div",{className:R()("meBoxMessage-metas",p.root,"isFlexed")},a&&c.createElement(A.Z,{timestamp:a,className:p.meta}),this.props.type===x.MESSAGE&&c.createElement("span",{className:p.meta},1===this.props.countMessages&&c.createElement(O.Z,{source:"<0/> message",c0:1}),this.props.countMessages>1&&c.createElement(O.Z,{source:"<0/> messages",c0:this.props.countMessages})))),!n&&c.createElement(l.Z,{className:R()("meBoxMessage-status","isRead",m.status)}),n&&c.createElement("div",{title:(0,u.t)("Unread"),className:R()("u-flexSpacer","meBoxMessage-status","isUnread",m.status)},c.createElement("span",{className:"sr-only"},(0,u.t)("Unread")))))}}]),n}(c.Component)},99375:function(e,t,n){"use strict";n.d(t,{Z:function(){return h}});var r=n(22122),a=n(6610),o=n(5991),s=n(10379),i=n(46070),c=n(77608),u=n(67294),l=n(83673),f=n(51523),m=n(94184),p=n.n(m);function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,c.Z)(e);if(t){var a=(0,c.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,i.Z)(this,n)}}var h=function(e){(0,s.Z)(n,e);var t=d(n);function n(){return(0,a.Z)(this,n),t.apply(this,arguments)}return(0,o.Z)(n,[{key:"render",value:function(){var e=this,t=this.props.data.length,n=(0,f.V)();return u.createElement("div",{className:p()("meBoxMessageList",this.props.className)},t>0&&u.createElement("ul",{className:"meBoxMessageList-items"},this.props.data.map((function(t,n){return u.createElement(l.Z,(0,r.Z)({},t,{key:"MeBoxDropDownItemList-".concat(e.props.type,"-").concat(n)}))}))),0===t&&u.createElement("div",{className:p()("frameBody-noContentMessage",n.noContentMessage)},this.props.emptyMessage))}}]),n}(u.Component)},48697:function(e,t,n){"use strict";n.r(t),n.d(t,{MessagesContents:function(){return k},default:function(){return I}});var r,a,o=n(6610),s=n(5991),i=n(10379),c=n(46070),u=n(77608),l=n(67294),f=n(72688),m=n(51438),p=n(10366),d=n(88202),h=n(43498),g=n(22241),y=n(83673),v=n(61525),E=n(99375),b=n(64833),w=n(34182),Z=n(94184),x=n.n(Z),M=n(29571),C=n(15172),N=n(22964);!function(e){e.PARTICIPATING="participating",e.DELETED="deleted"}(r||(r={})),function(e){e.ALL="all",e.INSERT_USER="insertUser",e.LAST_INSERT_USER="lastInsertUser"}(a||(a={}));var O=n(14494),S=n(74138),R=n(57739);function B(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return D(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return D(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){i=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(i)throw o}}}}function D(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function A(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,u.Z)(e);if(t){var a=(0,u.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,c.Z)(this,n)}}var k=function(e){(0,i.Z)(n,e);var t=A(n);function n(){return(0,o.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"render",value:function(){var e=(0,d.tB)(),t=(0,b.t)("Messages");return l.createElement(w.Z,{className:this.props.className,canGrow:!0,header:l.createElement(m.Z,{title:t},l.createElement(v.Z,{title:(0,b.t)("New Message"),to:"/messages/add",buttonType:h.q.ICON,className:x()(e.pushRight)},l.createElement(S.j2,null))),body:l.createElement(M.Z,{className:x()("isSelfPadded")},this.renderContents()),footer:l.createElement(C.Z,null,l.createElement(v.Z,{className:x()(e.pushLeft),to:"/messages/inbox",buttonType:h.q.TEXT_PRIMARY},(0,b.t)("All Messages")))})}},{key:"componentDidMount",value:function(){this.props.status===N.Px.PENDING&&this.props.requestData()}},{key:"renderContents",value:function(){var e=this.props,t=e.status,n=e.data;return t===N.Px.SUCCESS&&n?l.createElement(E.Z,{emptyMessage:(0,b.t)("You do not have any messages yet."),className:"headerDropDown-messages",type:y.T.MESSAGE,data:this.props.data||[]}):l.createElement(p.Z,{small:!0,minimumTime:0,padding:10})}}]),n}(l.Component);var I=(0,O.$j)((function(e){var t=0,n=[],r=e.conversations.conversationsByID;if(r.data){var a,o=B(Object.values(r.data));try{var s=function(){var e=a.value,r=[],o=(new DOMParser).parseFromString(e.body,"text/html");!0===e.unread&&t++,e.participants.forEach((function(e){r.push(e.user)})),n.push({authors:r,countMessages:e.countMessages,message:o.body.textContent||"",photo:e.lastMessage.insertUser.photoUrl||null,photoAlt:(0,b.ei)('User: "%s"',[e.lastMessage.insertUser.name]),to:e.url,recordID:e.conversationID,timestamp:e.lastMessage.dateInserted,type:y.T.MESSAGE,unread:e.unread})};for(o.s();!(a=o.n()).done;)s()}catch(e){o.e(e)}finally{o.f()}n.sort((function(e,t){var n=new Date(e.timestamp).getTime(),r=new Date(t.timestamp).getTime();return n<r?1:n>r?-1:0}))}return{countUnread:t,data:n,status:r.status}}),(function(e){var t=new f.Z(e,g.ZP);return{requestData:function(){return t.getConversations({expand:a.ALL})}}}))((0,R.vm)(k))},51438:function(e,t,n){"use strict";n.d(t,{Z:function(){return h}});var r=n(22122),a=n(6610),o=n(5991),s=n(10379),i=n(46070),c=n(77608),u=n(67294),l=n(58508),f=n(68469),m=n(94184),p=n.n(m);function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,c.Z)(e);if(t){var a=(0,c.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,i.Z)(this,n)}}var h=function(e){(0,s.Z)(n,e);var t=d(n);function n(){return(0,a.Z)(this,n),t.apply(this,arguments)}return(0,o.Z)(n,[{key:"render",value:function(){var e=(0,f.g)();return u.createElement(l.Z,(0,r.Z)({},this.props,{className:p()(this.props.className,"frameHeaderWithAction",e.root)}),u.createElement("span",{className:p()("frameHeaderWithAction-action",e.action)},this.props.children))}}]),n}(u.PureComponent)}}]);