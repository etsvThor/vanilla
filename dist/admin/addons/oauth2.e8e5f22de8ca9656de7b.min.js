var vanillaadmin;(self.webpackChunkvanillaadmin=self.webpackChunkvanillaadmin||[]).push([[9854],{55818:function(t,e,r){"use strict";r.d(e,{U:function(){return I},o:function(){return O}});var n=r(81253),a=r(92137),u=r(6610),o=r(5991),c=r(63349),s=r(10379),i=r(46070),f=r(77608),h=r(96156),p=r(87757),l=r.n(p),d=r(22241),m=r(76006),v=r(40798),A=r(23536),y=r(67294),C=r(14494);function D(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=(0,f.Z)(t);if(e){var a=(0,f.Z)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,i.Z)(this,r)}}var Z=(0,r(99308).ZP)("@@authenticators"),I=function(t){(0,s.Z)(r,t);var e=D(r);function r(){var t;(0,u.Z)(this,r);for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return t=e.call.apply(e,[this].concat(o)),(0,h.Z)((0,c.Z)(t),"clearForm",t.bindDispatch(r.clearFormAC)),(0,h.Z)((0,c.Z)(t),"updateForm",t.bindDispatch(r.updateFormAC)),(0,h.Z)((0,c.Z)(t),"getAll",(function(e){var n=e.page,u=e.limit,o=void 0===u?10:u,c=e.type,s=void 0===c?"oauth2":c,i=(0,v.KP)(r.getAllAuthenticatorACs,(0,a.Z)(l().mark((function e(){var r,a,u;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.api.get("/authenticators?page=".concat(n,"&limit=").concat(o,"&type=").concat(s),{});case 2:return r=e.sent,a=m.Z.parseLinkHeader(r.headers.link,"page"),u={items:r.data,pagination:a},e.abrupt("return",u);case 6:case"end":return e.stop()}}),e)}))))(e);return t.dispatch(i)})),(0,h.Z)((0,c.Z)(t),"getEdit",(function(e){var n=(0,v.KP)(r.getEditAuthenticatorAC,(0,a.Z)(l().mark((function r(){var n;return l().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.api.get("/authenticators/".concat(e,"/oauth2"),{});case 2:return n=r.sent,r.abrupt("return",n.data);case 4:case"end":return r.stop()}}),r)}))))({authenticatorID:e});return t.dispatch(n)})),(0,h.Z)((0,c.Z)(t),"initForm",function(){var e=(0,a.Z)(l().mark((function e(r){var n;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.updateForm(A.Wr.data),!r){e.next=6;break}return e.next=4,t.getEdit(r);case 4:n=e.sent,t.updateForm(n);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),(0,h.Z)((0,c.Z)(t),"saveForm",function(){var e=(0,a.Z)(l().mark((function e(r){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r.authenticatorID){e.next=6;break}return e.next=3,t.patchForm(r);case 3:return e.abrupt("return",e.sent);case 6:return e.next=8,t.postForm(r);case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),(0,h.Z)((0,c.Z)(t),"setActive",(function(e,n){var u={authenticatorID:e,active:n},o=(0,v.KP)(r.patchFormACs,(0,a.Z)(l().mark((function r(){var n;return l().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.api.patch("/authenticators/".concat(e),u);case 2:return n=r.sent,r.abrupt("return",n.data);case 4:case"end":return r.stop()}}),r)}))))(u);return t.dispatch(o)})),t}return(0,o.Z)(r,[{key:"postForm",value:function(t){var e=this,n=(0,v.KP)(r.postFormACs,function(){var r=(0,a.Z)(l().mark((function r(n){var a;return l().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.api.post("/authenticators/oauth2",t);case 2:return a=r.sent,r.abrupt("return",a.data);case 4:case"end":return r.stop()}}),r)})));return function(t){return r.apply(this,arguments)}}())(t);return this.dispatch(n)}},{key:"deleteAuthenticator",value:function(t){var e=this,n=(0,v.KP)(r.deleteAuthenticatorACs,function(){var r=(0,a.Z)(l().mark((function r(n){var a;return l().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.api.delete("/authenticators/".concat(t));case 2:return a=r.sent,r.abrupt("return",a.data);case 4:case"end":return r.stop()}}),r)})));return function(t){return r.apply(this,arguments)}}())(t);return this.dispatch(n)}},{key:"patchForm",value:function(t){var e=this,u=t.authenticatorID,o=(0,n.Z)(t,["authenticatorID"]),c=(0,v.KP)(r.patchFormACs,(0,a.Z)(l().mark((function t(){var r,n;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.api.patch("/authenticators/".concat(u),o);case 2:r=t.sent,t.t0=r.data.type,t.next="oauth2"===t.t0?6:10;break;case 6:return t.next=8,e.api.patch("/authenticators/".concat(u,"/oauth2"),o);case 8:return n=t.sent,t.abrupt("return",n.data);case 10:return t.abrupt("return",r.data);case 11:case"end":return t.stop()}}),t)}))))(t);return this.dispatch(c)}}]),r}(v.ZP);function O(){var t=(0,C.I0)();return(0,y.useMemo)((function(){return new I(t,d.ZP)}),[t])}(0,h.Z)(I,"getAllAuthenticatorACs",Z.async("GET_ALL")),(0,h.Z)(I,"getEditAuthenticatorAC",Z.async("GET_EDIT")),(0,h.Z)(I,"updateFormAC",Z("UPDATE_FORM")),(0,h.Z)(I,"postFormACs",Z.async("POST")),(0,h.Z)(I,"patchFormACs",Z.async("PATCH")),(0,h.Z)(I,"deleteAuthenticatorACs",Z.async("DELETE")),(0,h.Z)(I,"clearFormAC",Z("CLEAR_FORM"))},23536:function(t,e,r){"use strict";var n;r.d(e,{mR:function(){return n},Wr:function(){return a},rv:function(){return u}}),function(t){t.CONSENT="consent",t.CONSENT_AND_LOGIN="consent and login",t.LOGIN="login",t.NONE="none"}(n||(n={}));var a={data:{authenticatorID:void 0,name:"",clientID:"",secret:"",type:"oauth2",urls:{},userMappings:{uniqueID:"user_id",email:"email",name:"displayname",fullName:"name",photoUrl:"picture",roles:"roles"},authenticationRequest:{scope:"",prompt:n.LOGIN},useBearerToken:!1,allowAccessTokens:!1,active:!0,default:!1,visible:!0},status:void 0,error:void 0},u={authenticatorsByID:{},authenticatorIDsByHash:{},form:a,deleteState:{}}},33493:function(t,e,r){"use strict";r.r(e);var n=r(67294),a=r(89279),u=r(91729),o=new u.Z((function(){return Promise.all([r.e(2623),r.e(2004),r.e(3484),r.e(9467),r.e(8462)]).then(r.bind(r,28182))}),"/oauth2-settings",(function(){return"/oauth2-settings"})),c=new u.Z((function(){return Promise.all([r.e(2623),r.e(2004),r.e(3484),r.e(9467)]).then(r.bind(r,19467))}),["/oauth2-settings/add","/oauth2-settings/:authenticatorID/edit"],(function(t){return null!=t.authenticatorID?"/oauth2-settings/".concat(t.authenticatorID,"/edit"):"/oauth2-settings/add"})),s=[o.route,c.route],i=r(18452),f=r(96156),h=r(23536),p=r(55818),l=r(87219),d=r(76983),m=r(22964),v=r(61403);function A(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function y(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?A(Object(r),!0).forEach((function(e){(0,f.Z)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):A(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var C=(0,l.ZP)((0,d.reducerWithInitialState)(h.rv).case(p.U.getAllAuthenticatorACs.started,(function(t,e){var r=(0,v.Q6)(e);return t.authenticatorIDsByHash[r]={status:m.Px.LOADING},t})).case(p.U.getAllAuthenticatorACs.failed,(function(t,e){var r=(0,v.Q6)(e.params);return t.authenticatorIDsByHash[r]={status:m.Px.ERROR,error:e.error},t})).case(p.U.getAllAuthenticatorACs.done,(function(t,e){var r=(0,v.Q6)(e.params),n=e.result,a=n.items,u=n.pagination;return t.authenticatorIDsByHash[r]={status:m.Px.SUCCESS,data:{items:a.map((function(t){return t.authenticatorID})),pagination:u}},a.forEach((function(e){t.authenticatorsByID[e.authenticatorID]=e})),t})).case(p.U.getEditAuthenticatorAC.started,(function(t){return t.form.status=m.Px.LOADING,t})).case(p.U.getEditAuthenticatorAC.failed,(function(t,e){return t.form.status=m.Px.ERROR,t.form.error=e.error,t})).case(p.U.getEditAuthenticatorAC.done,(function(t,e){return t.form.status=m.Px.SUCCESS,t.form.data=e.result,t})).case(p.U.postFormACs.started,(function(t,e){return t.form.status=m.Px.LOADING,t})).case(p.U.postFormACs.failed,(function(t,e){return t.form.status=m.Px.ERROR,t.form.error=e.error,t})).case(p.U.postFormACs.done,(function(t,e){return t.form.status=m.Px.SUCCESS,t.authenticatorsByID={},t.authenticatorIDsByHash={},t})).case(p.U.patchFormACs.started,(function(t,e){return t.form.status=m.Px.LOADING,t})).case(p.U.patchFormACs.failed,(function(t,e){return t.form.status=m.Px.ERROR,t.form.error=e.error,t})).case(p.U.patchFormACs.done,(function(t,e){t.form.status=m.Px.SUCCESS;var r=e.result;if(r.authenticatorID){var n,a=null===(n=t.authenticatorsByID[r.authenticatorID])||void 0===n?void 0:n.default,u=r.default;!a&&u&&Object.values(t.authenticatorsByID).forEach((function(t){t.default=!1})),t.authenticatorsByID[r.authenticatorID]=r}return t})).case(p.U.updateFormAC,(function(t,e){return t.form.data=y(y({},t.form.data),e),t})).case(p.U.clearFormAC,(function(t){return t.form=h.Wr,delete t.form.error,t})).case(p.U.deleteAuthenticatorACs.started,(function(t,e){return t.deleteState={authenticatorID:e,status:m.Px.LOADING,error:void 0},t})).case(p.U.deleteAuthenticatorACs.failed,(function(t,e){return t.deleteState={authenticatorID:e.params,status:m.Px.ERROR,error:e.error},t})).case(p.U.deleteAuthenticatorACs.done,(function(t,e){return t.deleteState={authenticatorID:e.params,status:m.Px.SUCCESS,error:void 0},t.authenticatorsByID={},t.authenticatorIDsByHash={},t}))),D=r(35996);a.F.addRoutes(s),(0,D.xw)("authenticators",C),(0,i.Tk)("oauth2App",(function(){return n.createElement(a.F,{sectionRoots:["/oauth2-settings"]})}))}},function(t){"use strict";var e=function(e){return t(t.s=e)};t.O(0,[8780,5163,9833,5852,6936,9494,7014,3269,8520,7061,8317,8614,1385,5096,9283,2053,8089,6337,9841,5677,390,5449,2387,4926,3432,3079,4682,4065,3509,3360,4211,2492,7086,2167,7025,924,4401,1628,9584,1467],(function(){return e(2702),e(33493)}));var r=t.O();vanillaadmin=r}]);